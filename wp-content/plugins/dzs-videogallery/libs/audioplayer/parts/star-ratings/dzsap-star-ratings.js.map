{"version":3,"sources":["../../../../../../../../../../../../../usr/local/lib/node_modules/browserify/node_modules/browser-pack/_prelude.js","dzsap-star-ratings.source.js"],"names":[],"mappings":"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","file":"bundle.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()","window.dzsap_part_starRatings_loaded = 'on';\n\n\nclass dzsapStarRatingsSource {\n  constructor(dzsapClass) {\n\n    this.$ratingCon = null;\n    this.inputStarSize = 20;\n    this.inputStarNumber = 5;\n    this.inputStarFormat = '<span style=\"width: 20px;\">&#9733;</span>';\n    this.dzsap = dzsapClass;\n\n    this.init();\n\n\n  }\n\n  viewUpdateStarSizes(){\n\n\n    const selfStarInstance = this;\n    const dzsapClass = this.dzsap;\n\n    const indexToPerc = Number(selfStarInstance.$ratingCon.eq(0).attr('data-initial-rating-index'));\n    let auxnr = Number(selfStarInstance.$ratingCon.eq(0).attr('data-initial-rating-index')) * 100;\n\n\n\n    if (dzsapClass.starrating_alreadyrated > -1 && dzsapClass.starrating_alreadyrated > 0) {\n      auxnr = dzsapClass.starrating_alreadyrated * 100 / selfStarInstance.inputStarNumber;\n    }\n\n    dzsapClass.cthis.find('.rating-prog').css({\n      'width': auxnr + '%'\n    })\n\n\n    dzsapClass.cthis.find('.star-rating-set-clip').css({\n      'opacity': 1\n    })\n    dzsapClass.cthis.find('.star-rating-set-clip').css({\n      'width': selfStarInstance.inputStarSize * selfStarInstance.inputStarNumber * indexToPerc\n    })\n  }\n\n  init() {\n\n    const selfStarInstance = this;\n    const dzsapClass = this.dzsap;\n    const $ = jQuery;\n    var starrating_index = 0;\n\n    this.$ratingCon = dzsapClass.cthis.find('.star-rating-con');\n\n    this.$ratingCon.get(0).selfStarInstance = selfStarInstance;\n\n\n    initVisual();\n\n\n    function initVisual() {\n\n      for (let i = 0; i < selfStarInstance.inputStarNumber; i++) {\n        selfStarInstance.$ratingCon.find('.star-rating-bg').append(selfStarInstance.inputStarFormat);\n        selfStarInstance.$ratingCon.find('.star-rating-prog').append(selfStarInstance.inputStarFormat);\n      }\n    }\n\n    function mouse_starrating(e) {\n      var $t = $(this);\n\n\n      if (dzsapClass.cthis.has($t).length === 0) {\n        return;\n      }\n\n      if (e.type === 'mouseleave') {\n        selfStarInstance.viewUpdateStarSizes()\n\n      }\n      if (e.type === 'mousemove') {\n        var mx = e.pageX - $t.offset().left;\n        var my = e.pageX - $t.offset().left;\n\n\n        starrating_index = Math.round(mx / ($t.outerWidth() / 5));\n\n\n        if (starrating_index > 4) {\n          starrating_index = 5;\n        } else {\n          starrating_index = Math.round(starrating_index);\n        }\n\n        if (starrating_index < 1) {\n          starrating_index = 1;\n        }\n\n\n        dzsapClass.cthis.find('.star-rating-prog-clip').css({\n          'width': (starrating_index / 5 * 100) + '%'\n        })\n\n        dzsapClass.starrating_alreadyrated = -1;\n\n\n        dzsapClass.cthis.find('.star-rating-set-clip').css({\n          'opacity': 0\n        })\n      }\n      if (e.type === 'click') {\n\n\n        dzsapClass.starrating_alreadyrated = -1;\n        if (dzsapClass.starrating_alreadyrated > -1 && dzsapClass.starrating_alreadyrated > 0) {\n          return;\n        }\n\n        ajax_submit_rating(dzsapClass, starrating_index);\n      }\n\n\n    }\n\n\n    $(document).on('mousemove', '.star-rating-con', mouse_starrating);\n    $(document).on('mouseleave', '.star-rating-con', mouse_starrating);\n    $(document).on('click', '.star-rating-con', mouse_starrating);\n  }\n}\n\n/**\n * only handles ajax call + result\n * @param dzsapInstance\n * @param starrating_index\n */\nfunction ajax_submit_rating(dzsapInstance, starrating_index) {\n\n\n  var $ = jQuery;\n\n\n  var data = {\n    action: 'dzsap_submit_rate',\n    postdata: starrating_index,\n    playerid: dzsapInstance.the_player_id\n  };\n\n\n  const onSuccess = (response) => {\n\n\n\n    let responseArr = {};\n\n    try {\n      responseArr = JSON.parse(response);\n    } catch (e) {\n    }\n\n    var percentSetRating = dzsapInstance.cthis.find('.star-rating-set-clip').outerWidth() / dzsapInstance.cthis.find('.star-rating-bg').outerWidth();\n    let nrOfRates = parseInt(dzsapInstance.cthis.find('.counter-rates .the-number').html(), 10);\n\n    nrOfRates++;\n\n    var percentFinalRating = ((nrOfRates - 1) * (percentSetRating * 5) + starrating_index) / (nrOfRates)\n\n\n    setTimeout(function () {\n\n      dzsapInstance.cthis.find('.star-rating-con').removeClass('just-rated');\n    }, 100);\n    dzsapInstance.cthis.find('.counter-rates .the-number').html(responseArr.rate_nr);\n\n    dzsapInstance.cthis.find('.star-rating-con').attr('data-initial-rating-index', Number(responseArr.rate_index) / 5);\n    dzsapInstance.cthis.find('.star-rating-con .rating-prog').css('width', (Number(responseArr.rate_index) / 5 * 100) + '%');\n\n    if (dzsapInstance.initOptions.parentgallery && $(dzsapInstance.initOptions.parentgallery).get(0) !== undefined && $(dzsapInstance.initOptions.parentgallery).get(0).api_player_rateSubmitted) {\n      $(dzsapInstance.initOptions.parentgallery).get(0).api_player_rateSubmitted();\n    }\n  }\n\n\n\n\n  if (dzsapInstance.starrating_alreadyrated > -1) {\n    return;\n  }\n\n  dzsapInstance.cthis.find('.star-rating-con').addClass('just-rated');\n  let totalWidth = parseInt(dzsapInstance.cthis.find('.star-rating-bg').width(), 10);\n  if (dzsapInstance.urlToAjaxHandler) {\n    jQuery.ajax({\n      type: \"POST\",\n      url: dzsapInstance.urlToAjaxHandler,\n      data: data,\n      success: onSuccess,\n      error: function (arg) {\n\n\n        var widthStarRatingClip = dzsapInstance.selfClass.cthis.find('.star-rating-set-clip').outerWidth() / dzsapInstance.cthis.find('.star-rating-bg').outerWidth();\n        var nrrates = parseInt(dzsapInstance.cthis.find('.counter-rates .the-number').html(), 10);\n\n        nrrates++;\n\n        var aux2 = ((nrrates - 1) * (widthStarRatingClip * 5) + starrating_index) / (nrrates)\n\n\n        dzsapInstance.cthis.find('.star-rating-set-clip').width(aux2 * (totalWidth / 5));\n        dzsapInstance.cthis.find('.counter-rates .the-number').html(nrrates);\n\n        if (dzsapInstance.initOptions.parentgallery && $(dzsapInstance.initOptions.parentgallery).get(0) && $(dzsapInstance.initOptions.parentgallery).get(0).api_player_rateSubmitted) {\n          $(dzsapInstance.initOptions.parentgallery).get(0).api_player_rateSubmitted();\n        }\n\n      }\n    });\n  }\n}\n\n\nwindow.dzsap_init_starRatings_from_dzsap = function (dzsapClass) {\n  var dzsapStarRatingsSourceInstance = new dzsapStarRatingsSource(dzsapClass);\n}\n"]}